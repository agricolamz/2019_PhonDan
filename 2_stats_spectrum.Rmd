---
editor_options: 
  chunk_output_type: console
---

# –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

–î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∫–æ–¥–æ–º, –≤–æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```{r, message=FALSE}
library(tidyverse)
library(lme4)
library(lmerTest)
# —ç—Ç–æ —Å—Ç–∏–ª—å –¥–ª—è ggplot (–º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –∫–æ–º–∞–Ω–¥—É)
theme_set(theme_bw()+
            theme(text = element_text(size = 16))) 
```

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ —è –∏—Å–ø–æ–ª—å–∑—É—é –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–±–æ—Ç—ã [Huttenlocher, Vasilyeva, Cymerman, Levine 2002], –≤ –∫–æ—Ç–æ—Ä–æ–π –∞–≤—Ç–æ—Ä—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ 46 –ø–∞—Ä –º–∞—Ç–µ—Ä–µ–π –∏ –¥–µ—Ç–µ–π (–≤–æ–∑—Ä–∞—Å—Ç–æ–º –æ—Ç 47 –¥–æ 59 –º–µ—Å—è—Ü–µ–≤, —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç ... –∞ –ø–∞—Å—á–∏—Ç–∞–π—Ç–µ —Å–∞–º–∏!). –û–Ω–∏ –∑–∞–ø–∏—Å–∞–ª–∏ –∏ –∑–∞—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–ª–∏ 2 —á–∞—Å–∞ –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è —Ä–µ–±–µ–Ω–∫–∞. –ü–æ—Ç–æ–º –æ–Ω–∏ –ø–æ—Å—á–∏—Ç–∞–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–º–µ–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —É –º–∞—Ç–µ—Ä–µ–π –∏ —Ä–µ–±–µ–Ω–∫–∞. –î–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –∫–æ–º–∞–Ω–¥–æ–π:
`np_acquisition <- read.csv("https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/Huttenlocher.csv")`

```{r}
np_acquisition <- read.csv("https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/Huttenlocher.csv")
np_acquisition
```


## 1 –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

### 1.1 –ü—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —Å–µ–±–µ, —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –Ω–∞—É—á–∏—Ç—å—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–º–µ–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø —É —Ä–µ–±–µ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–º–µ–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø —É –º–∞—Ç–µ—Ä–∏.

```{r}
np_acquisition %>% 
  ggplot(aes(mother, child))+
  geom_point()+
  labs(caption = "–¥–∞–Ω–Ω—ã–µ [Huttenlocher, Vasilyeva, Cymerman, Levine 2002]")
```

–ü—Ä–æ—Å—Ç–µ–π—à–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

$$y_i = \beta_0 + e_i$$

* $y_i$ --- –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤
* $\beta_0$ --- –Ω–µ–∫–æ—Ç–æ—Ä–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞
* $e_i$ --- –æ—Å—Ç–∞—Ç–∫–∏/–æ—à–∏–±–∫–∏ —Ä–µ–≥—Ä–µ—Å–∏–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

–¢–∞–∫ –∫–∞–∫ –ª—é–±–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è —É–ª—É—á—à–∏—Ç—å —Å–≤–æ–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –ª—É—á—à–∏–º –∫–æ—ç—Ñ–µ—Ü–∏–µ–Ω—Ç–æ–º $k$ –±—É–¥–µ—Ç —Ç–æ—Ç, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º $e_i$ –±—É–¥—É—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã. –í –Ω–∞—à–µ–π –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏ --- —ç—Ç–æ –ø–æ–Ω—è—Ç–Ω–æ–µ –¥–µ–ª–æ –±—É–¥–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ:

```{r}
np_acquisition %>% 
  ggplot(aes(mother, child))+
  geom_hline(aes(yintercept = (mean(mother))), color = "blue")+
  geom_point()+
  labs(caption = "–¥–∞–Ω–Ω—ã–µ [Huttenlocher, Vasilyeva, Cymerman, Levine 2002]")
```

$$child_j = mean(child) + e_j$$

–ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `mother` –≤ –Ω–∞—à—É —Ä–µ–≥—Ä–µ—Å—Å–∏—é, —Ç–æ –º—ã —ç—Ç–æ –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–æ—Ä–º—É–ª—É –ø—Ä—è–º–æ–π:

$$y_j = \beta_0 + \beta_1\times x_j + e_j$$

```{r}
np_acquisition %>% 
  ggplot(aes(mother, child))+
  geom_smooth(method = "lm", se = FALSE)+
  geom_point()+
  labs(caption = "–¥–∞–Ω–Ω—ã–µ [Huttenlocher, Vasilyeva, Cymerman, Levine 2002]")
```

–¢. –µ. —Ñ–æ—Ä–º—É–ª–∞ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –Ω–∞—à–∏–º –¥–∞–Ω–Ω—ã–º –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

$$child_j = \beta_0 + \beta_1\times mother_j + e_j$$

–í R —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `lm`:

```{r}
lm(child~mother, data = np_acquisition)
```

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø–∏—Å–∞—Ç—å —Ñ–æ—Ä–º—É–ª—É:

$$child_j = 0.7038 + 0.5452 \times mother_j + e_j$$

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∞ –ø–æ—Ç–æ–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–∂–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤:

```{r}
fit <- lm(child~mother, data = np_acquisition)
summary(fit)
```

–ù–∞ —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:

* –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
* Adjusted R-–∫–≤–∞–¥—Ä–∞—Ç
* –Ω–∞ p-value –≤—Å–µ–π –º–æ–¥–µ–ª–∏

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å! –ü—Ä–∞–≤–¥–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—Å–µ —Ä—É–∫–∞–º–∏ –≤–±–∏–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º—É–ª—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏—è `mother = 1.69`:

```{r}
predict(fit, newdata = data.frame(mother = 1.69))
```


> ü§î –°–∫–∞—á–∞–π—Ç–µ [–¥–∞—Ç–∞—Å–µ—Ç —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ä–∞—Å—Å–∫–∞–∑–æ–≤ –ê. –ü. –ß–µ—Ö–æ–≤–∞](https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/chekhov.csv): –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤, –¥–ª–∏–Ω–∞ —Ä–∞—Å—Å–∫–∞–∑–∞. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–ª–∏–Ω—ã —Ä–∞—Å—Å–∫–∞–∑–∞. –ö–∞–∫–æ–π –ø–æ–ª—É—á–∏–ª—Å—è –∏–Ω—Ç–µ—Ä—Å–µ–ø—Ç (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 4 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)?

<form name="FormOne" onsubmit="return validateFormOne()" method="post">
<input type="text" name="answerOne">
<input type="submit" value="check">
</form><br>

> ü§î –ö–∞–∫–æ–π –ø–æ–ª—É—á–∏–ª—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω–∞ —Ä–∞—Å—Å–∫–∞–∑–∞ (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 4 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)?

<form name="FormTwo" onsubmit="return validateFormTwo()" method="post">
<input type="text" name="answerTwo">
<input type="submit" value="check">
</form><br>

> ü§î –ß—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –¥–ª—è —Ä–∞—Å—Å–∫–∞–∑–∞ —Ä–∞–∑–º–µ—Ä–æ–º 855 —Å–ª–æ–≤  (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 4 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)?

<form name="FormThree" onsubmit="return validateFormThree()" method="post">
<input type="text" name="answerThree">
<input type="submit" value="check">
</form><br>

### 1.2 –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–ê —á—Ç–æ –µ—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —É –Ω–∞—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–∞—è? –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤–≤–æ–¥—è—Ç—Å—è *dummy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ*. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞—à –≤—á–µ—Ä–∞—à–Ω–∏–π –ø—Ä–∏–º–µ—Ä [–∏–∑ [Hau 2007]](https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/Hau.2007.csv): 

```{r}
homo <- read.csv("https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/Hau.2007.csv")
```

–ü–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å s –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ —Å–ø–∏–∫–µ—Ä–∞. –î–ª—è —ç—Ç–æ–≥–æ –≤ —Ä–µ–≥—Ä—Å—Å–∏—é –≤–≤–æ–¥—è—Ç —Ç–∞–∫-–Ω–∞–∑—ã–≤–∞–µ–º—ã–µ *dummy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ*. Dummy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –ª–∏—à—å –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ª–∏–±–æ 1, –ª–∏–±–æ 0. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ 1 --- –≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª, 0 --- –≥–µ—Ç–µ—Ä–æ—Å–µ–∫—Å—É–∞–ª.

```{r}
homo %>% 
  ggplot(aes(orientation, s.duration.ms))+
  geom_point()
```

–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –Ω–∞—à–∞ —Ñ–æ—Ä–º—É–ª–∞ –ø—Ä–∏–º–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥:

$$y_j = \beta_0 + \beta_1\times x + e_j$$

$$s\_duration_j = \beta_0 + \beta_1\times orientation_j + e_j$$

–ü—Ä–∏ –æ–ø–∏—Å–∞–Ω–∏–∏ –≥–µ—Ç–µ—Ä–æ—Å–µ–∫—Å—É–∞–ª–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è $orientation = 0$, —Ç–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–∏–¥: 
$$s\_duration_j = \beta_0 + \beta_1\times orientation_j + e_j = \beta_0 + \beta_1\times 0 + e_j = \beta_0 + e_j$$


–ü—Ä–∏ –æ–ø–∏—Å–∞–Ω–∏–∏ –≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è $orientation = 1$, —Ç–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–∏–¥:
$$s\_duration_j = \beta_0 + \beta_1\times orientation_j + e_j = \beta_0 + \beta_1\times 1 + e_j = \beta_0 + \beta_1 + e_j$$

```{r}
fit <- lm(s.duration.ms~orientation, data = homo)
summary(fit)
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —ç—Ç–∞ –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ–≥–æ –¥–≤–∞ —á–∏—Å–ª–∞: –≥–µ—Ç–µ—Ä–æ—Å–µ–∫—Å—É–∞–ª—ã --- $58.466$, –≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª—ã --- $58.466+5.517=63.983$.

**–û–ß–ï–ù–¨ –í–ê–ñ–ù–û:** dummy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤—Å–µ–≥–¥–∞ (n-1). –¢. –µ. –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π 7, —Ç–æ dummy-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—É–¥–µ—Ç 6 –∏ —Ç. –¥.

**–û–ß–ï–ù–¨ –í–ê–ñ–ù–û:** —Å–∫–æ–ª—å–∫–æ –±—ã –Ω–µ –±—ã–ª–æ –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö, —Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é (reference level) –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –µ–µ —Å–æ –≤—Å–µ–º–∏. –¢. –µ. –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –≤ –∏–Ω—Ç–µ—Ä—Å–µ–ø—Ç–µ –Ω–µ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è, –æ–¥–Ω–∞–∫–æ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å reference level –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ç–∏–ø–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `factor`.

```{r}
homo$orientation <- factor(homo$orientation, levels = c("homo", "hetero"))
fit <- lm(s.duration.ms~orientation, data = homo)
summary(fit)
```

> ü§î –°–∫–∞—á–∞–π—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç [–¥–∞–Ω–Ω—ã–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–≥–ª–∞—Å–Ω—ã—Ö –≤ —è–∑—ã–∫–∞—Ö –º–∏—Ä–∞](https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/phoible_ejectives.csv). –ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—Ä–µ—Å—Å–∏—é –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≥–ª–∞—Å–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –Ω–∞–ª–∏—á–∏—è –∞–±—Ä—É–ø—Ç–∏–≤–Ω—ã—Ö. –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä—Å–µ–ø—Ç –º–æ–¥–µ–ª–∏ (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 4 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π):

```{r, include=FALSE}
ejectives <- read_csv("https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/phoible_ejectives.csv")
fit <- lm(total~have_ejectives, data = ejectives)
summary(fit)
```

<form name="FormFour" onsubmit="return validateFormFour()" method="post">
<input type="text" name="answerFour">
<input type="submit" value="check">
</form><br>

> ü§î –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `have_ejectives` (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 4 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π):

<form name="FormFive" onsubmit="return validateFormFive()" method="post">
<input type="text" name="answerFive">
<input type="submit" value="check">
</form><br>


### 1.3 –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

–í —Ü–µ–ª–æ–º, –≤–æ–æ–±—â–µ-—Ç–æ –º–æ–∂–Ω–æ –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∞ —Å—Ä–∞–∑—É –º–Ω–æ–≥–æ. –≠—Ç–æ —Å–ª–æ–∂–Ω–µ–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫ –∂–µ:

$$y_j = \beta_0 + \beta_1 \times x_{1j} + \dots + \beta_k \times x_{kj} + e_j$$

–ö—Ä–æ–º–µ —Ç–æ–≥–æ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏, –≤—ã–±–∏—Ä–∞—è –º–æ–¥–µ–ª–∏ —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º–∏ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞–º–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (—Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π --- –∫—Ä–∏—Ç–µ—Ä–∏–π –ê–∫–∞–∏–∫–µ, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `AIC`)
  
> ü§î –í –¥–∞—Ç–∞—Å–µ—Ç–µ –ø—Ä–æ –≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª–æ–≤ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ –Ω–æ—Å–∏—Ç–µ–ª–µ–π –∫–∞–∫ –≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å s,  —Å—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–Ω–∞ –∏ —Ä–∞–∑–º–µ—Ä –¥–∏–∞–ø–æ–∑–æ–Ω–∞ —á–∞—Å—Ç–æ—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–Ω–∞. –ü—Ä–≤–∏–µ–¥–∏—Ç–µ $R^2$ –ø–æ–ª—É—á–∏–≤—à–µ–π—Å—è –º–æ–¥–µ–ª–∏ (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ —Ç—Ä–µ—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π):

```{r, include=FALSE}
summary(lm(perceived.as.homo.percent~s.duration.ms+average.f0.Hz+f0.range.Hz, data = homo))
# 0.238
```

<form name="FormSix" onsubmit="return validateFormSix()" method="post">
<input type="text" name="answerSix">
<input type="submit" value="check">
</form><br>

## 2. –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

### 2.1 –í–≤–µ–¥–µ–Ω–∏–µ
–ú—ã —Ö–æ—Ç–∏–º —á–µ–≥–æ-—Ç–æ —Ç–∞–∫–æ–≥–æ:
$$\underbrace{y}_{[-\infty, +\infty]}=\underbrace{\mbox{Œ≤}_0+\mbox{Œ≤}_1\cdot x_1+\mbox{Œ≤}_2\cdot x_2 + \dots +\mbox{Œ≤}_k\cdot x_k +\mbox{Œµ}_i}_{[-\infty, +\infty]}$$
–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å ‚Äî (–≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ) –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Å–ø–µ—Ö–æ–≤ –∫ –æ–±—â–µ–º—É —á–∏—Å–ª—É —Å–æ–±—ã—Ç–∏–π:
$$p = \frac{\mbox{# —É—Å–ø–µ—Ö–æ–≤}}{\mbox{# –Ω–µ—É–¥–∞—á} + \mbox{# —É—Å–ø–µ—Ö–æ–≤}}, \mbox{–æ–±–ª–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π: }[0, 1]$$
–®–∞–Ω—Å—ã ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Å–ø–µ—Ö–æ–≤ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–µ—É–¥–∞—á:
$$odds = \frac{p}{1-p} = \frac{p\mbox{(—É—Å–ø–µ—Ö–∞)}}{p\mbox{(–Ω–µ—É–¥–∞—á–∏)}}, \mbox{–æ–±–ª–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π: }[0, +\infty]$$
–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º —à–∞–Ω—Å–æ–≤:
$$\log(odds), \mbox{–æ–±–ª–∞—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π: }[-\infty, +\infty]$$

–ù–æ, —á—Ç–æ –Ω–∞–º –≥–æ–≤–æ—Ä–∏—Ç –ª–æ–≥–∞—Ä–∏—Ñ–º —à–∞–Ω—Å–æ–≤? –ö–∞–∫ –Ω–∞–º –µ–≥–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å?

```{r}
data_frame(n = 10,
           success = 1:9,
           failure = n - success,
           prob.1 = success/(success+failure),
           odds = success/failure,
           log_odds = log(odds),
           prob.2 = exp(log_odds)/(1+exp(log_odds)))
```

–ö–∞–∫ —Å–≤—è–∑–∞–Ω—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏ –ª–æ–≥–∞—Ä–∏—Ñ–º —à–∞–Ω—Å–æ–≤:
$$\log(odds) = \log\left(\frac{p}{1-p}\right)$$
$$p = \frac{\exp(\log(odds))}{1+\exp(\log(odds))}$$

–ö–∞–∫ —Å–≤—è–∑–∞–Ω—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏ –ª–æ–≥–∞—Ä–∏—Ñ–º —à–∞–Ω—Å–æ–≤:

```{r}
data_frame(p = seq(0, 1, 0.001),
           log_odds = log(p/(1-p))) %>% 
  ggplot(aes(log_odds, p))+
  geom_line()+
  labs(x = latex2exp::TeX("$log\\left(\\frac{p}{1-p}\\right)$"))+
  theme_bw()
```

### 2.2 –ü–æ—á–µ–º—É –Ω–µ –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é?
```{r}
lm_0 <- lm(as.integer(have_ejectives)~1, data = ejectives)
lm_1 <- lm(as.integer(have_ejectives)~total, data = ejectives)
lm_0
lm_1
```
–ü–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å:
$$ejectives = 1.316 \times consonants$$
–í—Ç–æ—Ä–∞—è –º–æ–¥–µ–ª—å:
$$ejectives = 0.4611 + 0.0353 \times consonants$$

```{r}
ejectives %>% 
  ggplot(aes(total, as.integer(have_ejectives)))+
  geom_point()+
  geom_smooth(method = "lm")+
  theme_bw()+
  labs(y = "ejectives (yes = 2, no = 1)")
```

### 2.3 –õ–æ–≥–∏—Ç: –º–æ–¥–µ–ª—å –±–µ–∑ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
–ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã, `glm` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–∏–±–±–ª–æ–º.
```{r}
logit_0 <- glm(have_ejectives~1, family = "binomial", data = ejectives)
summary(logit_0)
logit_0$coefficients
table(ejectives$have_ejectives)
log(111/872) # Œ≤0
111/(111+872) # p
exp(log(111/872))/(1+exp(log(111/872))) # p
```

### 2.4 –õ–æ–≥–∏—Ç: –º–æ–¥–µ–ª—å c –æ–¥–Ω–∏–º —á–∏—Å–ª–æ–≤—ã–º –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º
```{r}
logit_1 <- glm(have_ejectives~total, family = "binomial", data = ejectives)
summary(logit_1)
logit_1$coefficients

ejectives %>% 
  mutate(have_ejectives = as.integer(have_ejectives)) %>% 
  ggplot(aes(total, have_ejectives)) +
  geom_point()+
  theme_bw()+
  geom_smooth(method = "glm", 
              method.args = list(family = "binomial"),
              se = FALSE)
```

–ö–∞–∫–æ–≤–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –≤ —è–∑—ã–∫–µ —Å 29 —Å–æ–≥–ª–∞—Å–Ω—ã–º–∏ –µ—Å—Ç—å –∞–±—Ä—É–ø—Ç–∏–≤–Ω—ã–µ?
```{r}
logit_1$coefficients
```

$$\log\left({\frac{p}{1-p}}\right)_i=\beta_0+\beta_1\times consinants_i + \epsilon_i$$
$$\log\left({\frac{p}{1-p}}\right)=-12.1123347 + 0.4576095 \times 29 = 1.158341$$
$$p = \frac{e^{1.158341}}{1+e^{1.158341}} = 0.7610311$$

```{r}
# log(odds)
predict(logit_1, newdata = data.frame(total = 29))
# p
predict(logit_1, newdata = data.frame(total = 29), type = "response")
```

### 2.5 –õ–æ–≥–∏—Ç: –º–æ–¥–µ–ª—å c –æ–¥–Ω–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º
```{r}
logit_2 <- glm(have_ejectives~area, family = "binomial", data = ejectives)
summary(logit_2)
logit_2$coefficients
table(ejectives$have_ejectives, ejectives$area)
log(1/6) # Eurasia
log(3/1) # North America
```

### 2.6 –õ–æ–≥–∏—Ç: –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
```{r}
logit_3 <- glm(have_ejectives~total+area, family = "binomial", data = ejectives)
summary(logit_3)
```

### 2.7 –õ–æ–≥–∏—Ç: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
```{r}
AIC(logit_0)
AIC(logit_1)
AIC(logit_2)
AIC(logit_3)
```

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –Ω—É–∂–Ω–æ –ø—Ä–æ–¥–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—é:
```{r}
(exp(logit_1$coefficients)-1)*100
```
–ü–µ—Ä–µ–¥ –Ω–∞–º–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–Ω–∏–µ —à–∞–Ω—Å–æ–≤ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ 1.

–ë—ã–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –º–Ω–æ–≥–æ –∞–Ω–∞–ª–æ–≥–æ–≤ R$^2$, –Ω–∞–ø—Ä–∏–º–µ—Ä, McFadden's R squared:
```{r}
pscl::pR2(logit_1)
```

> ü§î –í –¥–∞—Ç–∞—Å–µ—Ç–µ –ø—Ä–æ –≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª–æ–≤ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é –Ω–æ—Å–∏—Ç–µ–ª–µ–π  –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å s,  —Å—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–Ω–∞ –∏ —Ä–∞–∑–º–µ—Ä –¥–∏–∞–ø–æ–∑–æ–Ω–∞ —á–∞—Å—Ç–æ—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–Ω–∞. –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–µ `average.f0.Hz` –ø–æ–ª—É—á–∏–≤—à–µ–π—Å—è –º–æ–¥–µ–ª–∏ (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 3 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π).

```{r, include=FALSE}
homo_fit <- glm(orientation~s.duration.ms+average.f0.Hz+ f0.range.Hz, family = "binomial", data = homo)
summary(homo_fit)
# -0.025
```

<form name="FormSeven" onsubmit="return validateFormSeven()" method="post">
<input type="text" name="answerSeven">
<input type="submit" value="check">
</form><br>

> ü§î –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±—ã—Ç—å –≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª–æ–º —Å —É—Å–ª–æ–≤–∏–µ–º `s.duration.ms = 62, average.f0.Hz =120, f0.range.Hz = 60. –û—Ç–≤–µ—Ç –ø—Ä–∏–≤–µ–¥–∏—Ç–µ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 3 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.

```{r, include=FALSE}
predict(homo_fit, newdata = data.frame(s.duration.ms = 62,average.f0.Hz =120, f0.range.Hz = 60), type = "response")
```


<form name="FormEight" onsubmit="return validateFormEight()" method="post">
<input type="text" name="answerEight">
<input type="submit" value="check">
</form><br>

## 3 –†–µ–≥—Ä–µ—Å—Å–∏—è —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏

In this dataset we have number of consonants and vowels in 402 languages collected from UPSID database (http://www.lapsyd.ddl.ish-lyon.cnrs.fr/lapsyd/). There is an variable of the area based on Glottolog (http://glottolog.org/). In this part we will try to make models that predict number of vowels by number of consonants.

```{r, warning= FALSE}
upsid <- read_csv("https://raw.githubusercontent.com/agricolamz/2019_data_analysis_for_linguists/master/data/upsid.csv")
upsid

lingtypology::map.feature(upsid$language, 
                          features = upsid$area,
                          label = upsid$language,
                          label.hide = TRUE)
```


```{r}
upsid %>% 
  ggplot(aes(consonants, vowels))+
  geom_point()+
  labs(x = "number of consonants",
       y = "number of vowels",
       caption = "data from LAPSyD")+
  theme_bw()
```

–û–±–≤–µ–¥–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ –∫–∞–∂–¥–æ–º—É —Å–ø–∏–∫–µ—Ä—É:
```{r}
upsid %>% 
  ggplot(aes(consonants, vowels, color = area))+
  geom_point()+
  labs(x = "number of consonants",
       y = "number of vowels",
       caption = "data from LAPSyD")+
  theme_bw()+
  stat_ellipse()
```

–ü–æ—Å—Ç—Ä–æ–∏–º –ø—Ä–æ—Å—Ç—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é –∏ –¥–æ–±–∞–≤–∏–º –µ–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫:
```{r}
fit1 <- lm(vowels~consonants, data = upsid)
summary(fit1)

upsid %>% 
  ggplot(aes(consonants, vowels))+
  geom_point()+
  labs(x = "number of consonants",
       y = "number of vowels",
       caption = "data from LAPSyD")+
  theme_bw()+
  geom_line(data = fortify(fit1), aes(x = consonants, y = .fitted), color = "blue")

fit2 <- lmer(vowels ~ consonants + (1|area), data = upsid)
summary(fit2)

upsid %>% 
  ggplot(aes(consonants, vowels))+
  geom_point()+
  labs(x = "number of consonants",
       y = "number of vowels",
       caption = "data from LAPSyD")+
  theme_bw() +
  geom_line(data = fortify(fit2), aes(x = consonants, y = .fitted, color = area))
```

–ï—Å–ª–∏ –º—ã –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º —Å–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:
```{r}
fit3 <- lmer(vowels ~ consonants + (1+consonants|area), data = upsid)
summary(fit3)

upsid %>% 
  ggplot(aes(consonants, vowels))+
  geom_point()+
  labs(x = "number of consonants",
       y = "number of vowels",
       caption = "data from LAPSyD")+
  theme_bw()+
  geom_line(data = fortify(fit3), aes(x = consonants, y = .fitted, color = area))

fit4 <- lmer(vowels ~ consonants + (0+consonants|area), data = upsid)
summary(fit4)

upsid %>% 
  ggplot(aes(consonants, vowels))+
  geom_point()+
  labs(x = "number of consonants",
       y = "number of vowels",
       caption = "data from LAPSyD")+
  theme_bw()+
  geom_line(data = fortify(fit4), aes(x = consonants, y = .fitted, color = area))
```


–ï—Å–ª–∏ –º—ã –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º —Å–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:
```{r}
fit5 <- lmer(vowels ~ consonants + (1|area) + (0+consonants|area), data = upsid)
summary(fit5)

upsid %>% 
  ggplot(aes(consonants, vowels))+
  geom_point()+
  labs(x = "number of consonants",
       y = "number of vowels",
       caption = "data from LAPSyD")+
  theme_bw()+
  geom_line(data = fortify(fit5), aes(x = consonants, y = .fitted, color = area))

fit0 <- lmer(vowels ~ 1 + (1|area) + (0+consonants|area), data = upsid)
summary(fit0)

anova(fit5, fit4, fit3, fit2, fit1, fit0)
```

### 3.1 Task
Pavel Duryagin ran an experiment on perception of vowel reduction in Russian language. The dataset shva includes the following variables:

* time1 - reaction time 1<\br>
* duration - duration of the vowel in the stimuly (in milliseconds, ms)<\br>
* time2 - reaction time 2<\br>
* f1, f2, f3 - the 1st, 2nd and 3rd formant of the vowel measured in Hz (for a short introduction into formants, see here)<\br>
* vowel - vowel classified according the 3-fold classification (A - a under stress, a - a/o as in the first syllable before the stressed one, y (stands for shva) - a/o as in the second etc. syllable before the stressed one or after the stressed syllable, cf. g[y]g[a]t[A]l[y] gogotala ‚Äòguffawed‚Äô). In this part, we will ask you to analyse correlation between f1, f2, and duration.

```{r}
shva <- read_tsv("https://raw.githubusercontent.com/agricolamz/2019_PhonDan/master/data/duryagin_ReductionRussian.txt")
shva %>% 
  ggplot(aes(x=f2, y=f1, color=vowel)) +
  geom_point(show.legend = FALSE) +
  scale_x_reverse()+
  scale_y_reverse()+
  labs(x = "f2",
       y = "f1",
       title = "f2 and f1 of the reduced and stressed vowels",
       caption = "Data from Duryagin 2018")
```

–ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—Ä–µ—Å—Å–∏—é —Å–æ —Å–º–µ—à–∞–Ω–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—è  f2 –Ω–∞ –æ—Å–Ω–æ–≤–µ f1 –∏ –≥–ª–∞—Å–Ω—ã–π -- –≤ —Å–ª—É—á–∞–π–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∞—Ö. –í –æ—Ç–≤–µ—Ç–µ –ø—Ä–∏–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏ f1 (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 4 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π:

```{r, include=FALSE}
fit2 <- lmer(f2~f1+(1|vowel), data = shva)
```

<form name="FormFour" onNineit="return validateFormFour()" Nineod="post">
<input type="text" name="answerFour">
<Ninet type="submit" value="check">
</form><br>


<script>
function validateFormOne() {
    var x = document.forms["FormOne"]["answerOne"].value;
    if (x != "77.9269") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

function validateFormTwo() {
    var x = document.forms["FormTwo"]["answerTwo"].value;
    if (x != "0.4938") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

function validateFormThree() {
    var x = document.forms["FormThree"]["answerThree"].value;
    if (x != "500.1245") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

function validateFormFour() {
    var x = document.forms["FormFour"]["answerFour"].value;
    if (x != "23.4771") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

function validateFormFive() {
    var x = document.forms["FormFive"]["answerFive"].value;
    if (x != "10.0455") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

function validateFormSix() {
    var x = document.forms["FormSix"]["answerSix"].value;
    if (x != "0.238") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

function validateFormSeven() {
    var x = document.forms["FormSeven"]["answerSeven"].value;
    if (x != "-0.025") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

function validateFormEight() {
    var x = document.forms["FormEight"]["answerEight"].value;
    if (x != "0.536") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}
function validateFormNine() {
    var x = document.forms["FormNine"]["answerNine"].value;
    if (x != "0.0689") {
        alert("–£ –º–µ–Ω—è –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç...");
        return false;
    } else {
        alert("–î–∞, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ");
        return false;
    }
}

</script>